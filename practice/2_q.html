<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script type="module">
    import { users } from './data/blogs.js'
    console.log(users)

    // users : {
    //   id: Number,
    //   name: String,
    //   email: String,
    //   blogs: BlogArray,
    //   comments: Array
    // }

    // blog: {
    //   id: Number,
    //   likeCount: Number,
    //   publish: Bool,
    //   title: String,
    //   tags: Array,
    //   comments: Array,
    // }

    // Q1: 宮本さくらさんのidは？
    const getValue = (data, key, key2, value) => {
      const valueList = data.map(el => el[key] === key2 ? el[value] : null)
      return valueList.reduce((el1, el2) => el1 === null ? el2 : el1)
    }
    console.log(getValue(users, "name", "宮本さくら", "id"))

    // Q2: 宮本さくらさんのブログで最もlikeCountの多いもののtitleは？
    const getObject = (data, key, key2) => {
      const obj = data.map(el => el[key] === key2 ? el : null)
      return obj.reduce((el1, el2) => el1 === null ? el2 : el1)
    }

    const makeList = (data, key) => data.map(el => el[key])
    const getMax = data => data.reduce((a,b) => Math.max(a,b))

    const sakuraBlogs = getObject(users, "name", "宮本さくら").blogs
    const maxLikeCount = getMax(makeList(sakuraBlogs, "likeCount"))
    console.log(getValue(sakuraBlogs, "likeCount", maxLikeCount, "title"))

    // Q3: 宮本さくらさんのブログで非公開になっているものの中の最大のlikeCountは？そのタイトルは？
    const privateSakuraBlogs = sakuraBlogs.filter(el => el["publish"] === false)
    const privateMaxCount = getMax(makeList(privateSakuraBlogs, "likeCount"))
    console.log(privateMaxCount)
    console.log(getValue(privateSakuraBlogs, "likeCount", privateMaxCount, "title"))

    // Q4: 宮本さくらさんのブログの公開率は？
    console.log(privateSakuraBlogs.length / sakuraBlogs.length)

    // Q5: 宮本さくらさんのブログに最もついているタグは？、その個数は？
    let sakuraTags = new Map()
    const count = (counter, li) => {
      li.map(el => el in counter ? counter[el] += 1 : counter[el] = 1)
    }
    sakuraBlogs.map(el => count(sakuraTags, el.tags))
    const maxCountTag = getMax(Object.keys(sakuraTags).map(el => sakuraTags[el]))
    console.log(maxCountTag)
    console.log(Object.keys(sakuraTags).map(el => sakuraTags[el] === maxCountTag ? el : null)
      .reduce((el1, el2) => el1 === null ? el2 : el1))

    // Q6: 全てのブログの中で最もLikeCountの多いもののタイトルは？
    let likeCounts = new Map()
    users.map(el => {
      el.blogs.map(el2 => likeCounts[el.name + '/' + el2.title] = el2.likeCount)
    })
    const maxLikeCountAll = getMax(Object.keys(likeCounts).map(el => likeCounts[el]))
    const maxLikeCountTitle = Object.keys(likeCounts).map(el => likeCounts[el] === maxLikeCountAll ? el : null).reduce((el1, el2) => el1 === null ? el2 : el1)
    console.log(maxLikeCountTitle.split('/')[1])

    // Q7: 全てのブログの中で最もLikeCountの多いもののユーザー名は？
    console.log(maxLikeCountTitle.split('/')[0])


  </script>
</body>

</html>